<!DOCTYPE html>
<html><head><title>tcz.facedebouc.sbs</title><meta charset="UTF-8"></head><body>
<h1>tcz.facedebouc.sbs - no-cost partial mirror for tinycorelinux extensions</h1>
<a href="#how-to">How to use this partial mirror?</a>,
<a href="#github-repo">github repo for this site</a>,
<a href="#git-lfs">Using <code>git lfs</code></a>,
<a href="#download-file">Downloading a file from github lfs storage</a>,
<h2 id="how-to">How to use this partial mirror?</h2>
<p>Modify your <code>/opt/tcemirror</code>. Originally mine had
<code>http://repo.tinycorelinux.net/</code> and I changed it to
<code>http://tcz.facedebouc.sbs/</code>. Some options of <code>tce-ab</code> don't work with
this partial mirror. I only wrote a <code>tags.db.gz</code> and <code>info.lst</code> which I found
in the scripts used by <code>tce-ab.</code> I only tested the search function of <code>tce-ab</code>.
</p>
<h3 id="tce-load-github-lfs"><code>tce-load-github-lfs</code></h3>
<p><code>tce-load -wi curl tce-load-github-lfs<code> is needed to download large <code>.tcz</code>
files. Read more below to understand why.
For more details about <code>tce-load-github-lfs</code> see
<a href="https://gitlab.com/linichotmailca/tce-load-github-lfs.git">linichotmailca/tce-load-github-lfs</a>
or check the source code in the tcz itself which are mounted at <code>/usr/local/tce-load-github-lfs/<code>
after executing <code>tce-load -i tce-load-github-lfs</code>
</p>
<p>Tested <code>tce-load-github-lfs<code> on my thinkpad 560z. It should work with any github pages
based partial mirror like this one here. Remember to change
<a href="./16.x/x86/tcz/organization.txt">organization.txt</a> and
<a href="./16.x/x86/tcz/repository.txt">repository.txt</a> because it is needed to correctly
download the file info which have the href.
</p>
<h2 id="github-repo">github repo for this site</h2>
<p>
For the files for this github pages site, see
<a href="https://github.com/linic/tcz.facedebouc.sbs">github - linic/tcz.facedebouc.sbs</a>
I'm experimenting to have a simple no-cost mirror for tcz files hosted in github.</p>
<h2 id="git-lfs">Using <code>git lfs</code></h2>
<p>Useful commands under debian: 
<code><pre>
apt install git-lfs
git lfs track "rust-*.tcz"
git add .gitattributes
git lfs migrate export --include="*" --everything
git lfs ls-files
git push origin main --force
</pre></code>
</p>
<p><code>.tcz</code> files tracked by LFS will return a file which looks like this:
<code><pre>
version https://git-lfs.github.com/spec/v1
oid sha256:dfadb3bca91d6ea050b328ba2faa1fd1d941ffe7097f2146e8c1b3a44c533f04
size 208289792
</pre></code>
This can be considered a "pointer". To get the file, the <code>oid</code> and <code>size</code> can
be used with <code>curl</code> in a body for a github API call. One way to make this work is by
hosting on the mirror the <code>.tcz</code> for curl. That way, the standard tiny core linux can
download <code>curl</code> normally using <code>wget</code>. Then, <code>curl</code> can be used to
get a <code>JSON</code> response with an <code>href</code> which can then be used to download
the file.</p>
<h2 id="download-file">Downloading a file from github lfs storage</h2>
<p>These are the precursor scripts which led to <a href="#tce-load-github-lfs"><code>tce-load-github-lfs</code></a></p>
<p>The following scripts exist and are used in this order:
<ol>
<li>
<a href="./make-pointer.sh"><code>./make-pointer.sh maybe-pointer.tcz</code></a> to check if
the <code>maybe-pointer.tcz</code> file is a pointer file. Regular <code>tce-load</code> will
fail at the <code>md5sum -c</code> check.
</li>
<li>
<a href="./download-lfs-file.sh"><code>./download-lfs-file.sh a.tcz.pointer</code></a>
to download the file from github lfs storage. Depends on the next scripts in the list.
The script that follow will be run as part of <code>./download-lfs-file.sh a.tcz.pointer</code>
</li>
<li>
<a href="./get-download-info.sh"><code>./get-download-info.sh a,tcz.pointer</code></a>
to get the download info from the github API. Which depends on the next 2.
</li>
<li>
<a href="./extract-oid.sh"><code>./extract-oid.sh</code></a> used within <code>./get-download-info.sh a.tcz.pointer</code> 
</li>
<li>
<a href="./extract-size.sh"><code>./extract-size.sh</code></a> used within <code>./get-download-info.sh a.tcz.pointer</code> 
</li>
<li>
<a href="./extract-href.sh"><code>./extract-href.sh</code></a> used within <code>./download-lfs-file.sh a.tcz.pointer</code> 
</li>
</ol>
</p>
<p>Contatto :  linic@hotmail.ca. Grazie.</p>
<p>
Il contenuto del sito web Ã¨ concesso in licenza 
<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.it">CC BY SA 4.0</a>
se non diversamente specificato.
</p></body></html>
